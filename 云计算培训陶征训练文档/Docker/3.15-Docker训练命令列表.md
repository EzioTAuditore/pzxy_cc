# 3.15-Dockerè®­ç»ƒå‘½ä»¤åˆ—è¡¨

## Dockerå‘½ä»¤ä¸€è§ˆ

### Dockerå®‰è£…

``` shell
# Dockerå®‰è£…
# 1. å¸è½½æ—§ç‰ˆæœ¬Docker
# 	å¸è½½å†…å®¹åŒ…æ‹¬ï¼šdocker docker-client	docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine
yum remove -y docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine
# 2. é…ç½®Dockerä»“åº“
# 	å®‰è£…yum-utils è¿›è¡Œä»“åº“å¿«æ·é…ç½®
yum install -y yum-utils
# 	æ·»åŠ dockerä»“åº“
yum-config-manger --add-repo ä»“åº“åœ°å€(åœ¨æ­¤ä½¿ç”¨åä¸ºäº‘ä»“åº“ï¼šhttps://repo.huaweicloud.com/docker-ce/linux/centos/docker-ce.repo)
# 3. å®‰è£…Docker
yum install -y docker-ce docker-ce-cli containerd.io
# 4. å¯åŠ¨DockeræœåŠ¡
systemctl start docker
```

### Dockeré•œåƒå‘½ä»¤

``` shell
# 1. æŸ¥çœ‹é•œåƒåˆ—è¡¨
# 	docker images
# 	å¸¸ç”¨å‚æ•°ï¼š-a åˆ—å‡ºæœ¬åœ°æ‰€æœ‰é•œåƒ
# 			-q åªæ˜¾ç¤ºé•œåƒID
docker images -a	# æŸ¥çœ‹æœ¬åœ°é•œåƒ

# 2. åˆ é™¤é•œåƒ
# 	docker rmi	IMAGE
# 	å¸¸ç”¨å‚æ•°ï¼š-f å¼ºåˆ¶åˆ é™¤
docker rmi centos	# åˆ é™¤'centos'é•œåƒ

# 3.æ ‡è®°é•œåƒ
# 	docker tag IMAGE[:TGA] [REGISTRYHOST/][USERNAME/]NAME[:TAG]
docker tag centos:v1 centos:v2	# ç»™'centos:v1'æ·»åŠ æ–°çš„æ ‡ç­¾'v2'
docker tag centos:v1 linux/centos:v1	# æŠŠ'centos:v1'å½’åˆ°'linux'ä»“åº“

# 4. ä½¿ç”¨Dockerfileæ–‡ä»¶åˆ›å»ºé•œåƒ
# 	docker build [OPTIONS] PATH | URL | -

# 5. æŸ¥çœ‹æŒ‡å®šé•œåƒåˆ›å»ºå†å²
# 	docker history [OPTIONS] IMAGE
# 	å¸¸ç”¨å‚æ•°ï¼š-H ä¸€é¢—éƒ½çš„æ ¼å¼æ‰“å°é•œåƒå¤§å°å’Œæ—¥æœŸï¼Œé»˜è®¤å¼€å¯
# 			-q ä»…åˆ—å‡ºæäº¤ID

# 6. å°†æŒ‡å®šé•œåƒä¿å­˜æˆtarå½’æ¡£æ–‡ä»¶
# 	docker save [OPTIONS] IMAGE [IMAGE...]
# 	å¸¸ç”¨å‚æ•°ï¼š-o è¾“å‡ºåˆ°æ–‡ä»¶
docker save -o my_centos_v2.tar centos:v2	# æŠŠ'centos:v2'é•œåƒä¿å­˜åˆ°'my_centos_v2.tar'

# 7. å¯¼å…¥å¹¶ä½¿ç”¨é•œåƒé•œåƒ
# 	docker load [OPTIONS]
# 	å¸¸ç”¨å‚æ•°ï¼š-i æŒ‡å®šå¯¼å…¥çš„æ–‡ä»¶
# 			-q ç²¾ç®€è¾“å‡ºä¿¡æ¯
docker load -i my_centos_v2.tar 	# å°†'my_centos_v2.tar'é•œåƒå¯¼å…¥

# 8. ä»å½’æ¡£æ–‡ä»¶ä¸­åˆ›å»ºé•œåƒ
# 	docker import [OPTIONS] file|URL|- [REPOSITORY[:TAG]]
# 	å¸¸ç”¨å‚æ•°ï¼š-c ä½¿ç”¨dockeræŒ‡ä»¤åˆ›å»ºé•œåƒ
# 			-m æäº¤æ—¶çš„è¯´æ˜æ–‡å­—
docker import my_centos_v2.tar linux/centos:v2	# å°†'my_centos_v2.tar'å¯¼å…¥åˆ°dockerå¹¶å‘½åä¸º'linux/centos:v2'

# 9. æœç´¢é•œåƒ
[root@docker_master ~]# docker search webapp
NAME                                 DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
training/webapp                                                                      77                   [OK]

# 10. ä¸‹è½½é•œåƒ
[root@docker_master ~]# docker pull training/webapp
Using default tag: latest
latest: Pulling from training/webapp
Image docker.io/training/webapp:latest uses outdated schema1 manifest format. Please upgrade to a schema2 image for better future compatibility. More information at https://docs.docker.com/registry/spec/deprecated-schema-v1/
#ã€€ğŸ‘‡è¿™é‡Œè¿›è¡Œåˆ†å±‚ä¸‹è½½ï¼Œå¦‚æœæœ¬æœºæœ‰å¯¹åº”çš„å±‚çº§ï¼Œå°±ä¸ä¼šè¿›è¡Œä¸‹è½½
e190868d63f8: Pull complete 
909cd34c6fd7: Pull complete 
0b9bfabab7c1: Pull complete 
a3ed95caeb02: Pull complete 
10bbbc0fc0ff: Pull complete 
fca59b508e9f: Pull complete 
e7ae2541b15b: Pull complete 
9dd97ef58ce9: Pull complete 
a4c1b0cb7af7: Pull complete 
Digest: sha256:06e9c1983bd6d5db5fba376ccd63bfa529e8d02f23d5079b8f74a616308fb11d
Status: Downloaded newer image for training/webapp:latest
docker.io/training/webapp:latest

# 11. 
```

### å®¹å™¨å‘½ä»¤

``` shell
# 1. ä½¿ç”¨é•œåƒè¿è¡Œå®¹å™¨
[root@docker_master ~]# docker run -d -P -h "webapp_01" training/webapp python app.py
c8099c6942ccc8cb7cdf8e7932add5315b825222be356475bf4e8e08f17c833f
# -d åå°è¿è¡Œ
```

